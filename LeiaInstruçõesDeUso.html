<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Autentica√ß√£o em Dois Fatores em Delphi</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/4.0.0/github-markdown.min.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #1e1e1e;
            color: #ffffff;
        }
        h1, h2, h3, h4 {
            color: #58a6ff;
        }
        pre {
            background-color: #2d2d2d;
            border: 1px solid #444c56;
            border-radius: 5px;
            padding: 16px;
            overflow-x: auto;
            position: relative;
        }
        code {
            background-color: #2d2d2d;
            border-radius: 3px;
            padding: 2px 4px;
            font-size: 90%;
            color: #e36291;
        }
        a {
            color: #58a6ff;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        .copy-button {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #444c56;
            border: none;
            border-radius: 5px;
            color: #ffffff;
            padding: 5px 10px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.3s;
            z-index: 1;
        }
        .copy-button:hover {
            background: #58a6ff;
        }

        .markdown-body {
            color: white !important;
        }
    </style>
</head>
<body class="markdown-body">
    <h1>Autentica√ß√£o em Dois Fatores em Delphi</h1>

    <p>Desenvolvi uma tela de login utilizando a tecnologia de autentica√ß√£o em duas etapas (2FA) e um dashboard em Delphi usando o conceito MVC (View, Model, Controller). O dashboard apresenta um grid com os usu√°rios cadastrados e os dispositivos conectados. As informa√ß√µes s√£o armazenadas e validadas em um banco de dados PostgreSQL, garantindo seguran√ßa e integridade dos dados.</p>

    <h2>Estrutura do MVC</h2>
    <ul>
        <li><strong>Model</strong>: Representa os dados e as regras de neg√≥cio.</li>
        <li><strong>View</strong>: A interface do usu√°rio, onde as informa√ß√µes s√£o apresentadas.</li>
        <li><strong>Controller</strong>: A l√≥gica que intermedia a comunica√ß√£o entre o Model e a View.</li>
    </ul>

    <h2>Configura√ß√µes</h2>

    <h3>1. Configura√ß√£o do Banco de Dados</h3>
    <p>Para que o sistema funcione corretamente, √© necess√°rio configurar a conex√£o com o banco de dados. Recomenda-se o uso do PostgreSQL.</p>

    <p><strong>Passos para configurar a conex√£o:</strong></p>
    <ol>
        <li>Acesse <code>projeto16.dao.Connection</code> no seu projeto.</li>
        <li>Clique com o bot√£o direito no componente <code>tfdConnection</code> (Connection).</li>
        <li>Selecione "Connection Editor".</li>
        <li>Preencha os campos conforme necess√°rio:</li>
    </ol>
    <ul>
        <li><strong>Database</strong>: Nome do banco de dados.</li>
        <li><strong>User_name</strong>: Nome de usu√°rio para acessar o banco.</li>
        <li><strong>Password</strong>: Senha do usu√°rio.</li>
        <li><strong>Server</strong>: Endere√ßo do servidor (use <code>localhost</code> se estiver rodando localmente).</li>
        <li><strong>Port</strong>: Por padr√£o, utilize <code>5432</code>.</li>
    </ul>
    <p><strong>Exemplo de configura√ß√£o</strong>: No meu exemplo, utilizei <code>localhost</code> como servidor, mas voc√™ pode especificar outro servidor, se necess√°rio.</p>

    <h2>Tabelas a serem criadas no banco Postgres</h2>

    <h3>Tabela Login</h3>
    <div style="position: relative;">
        <button class="copy-button" onclick="copyCode(this)">üìã Copiar</button>
        <pre><code class="language-bash">CREATE TABLE login (
    id SERIAL PRIMARY KEY,
    login VARCHAR(50) NOT NULL,
    senha VARCHAR(255) NOT NULL
);
</code></pre>
    </div>

    <h3>Tabela dispositivosconnected</h3>
    <div style="position: relative;">
        <button class="copy-button" onclick="copyCode(this)">üìã Copiar</button>
        <pre><code class="language-bash">CREATE TABLE dispositivosconnected (
    id SERIAL PRIMARY KEY,
    hostname VARCHAR(255) NOT NULL,
    sistema_operacional VARCHAR(255),
    iduser INTEGER,
    email VARCHAR(255)
);
</code></pre>
    </div>

    <h2>C√≥digo para criar a Trigger no banco Postgres para alterar o email na tabela dispositivos quando o email na tabela login for alterado</h2>
    <div style="position: relative;">
        <button class="copy-button" onclick="copyCode(this)">üìã Copiar</button>
        <pre><code class="language-bash">CREATE OR REPLACE FUNCTION update_email_dispositivos()
RETURNS TRIGGER AS $$
BEGIN
    UPDATE dispositivosconnected
    SET email = NEW.email
    WHERE iduser = NEW.id;
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;
</code></pre>
    </div>

    <div style="position: relative;">
        <button class="copy-button" onclick="copyCode(this)">üìã Copiar</button>
        <pre><code class="language-bash">CREATE TRIGGER trg_update_email
AFTER UPDATE OF email ON login
FOR EACH ROW
EXECUTE PROCEDURE update_email_dispositivos();
</code></pre>
    </div>

    <h2>Executando o Projeto</h2>
    <p>Ap√≥s configurar a conex√£o com o banco de dados, voc√™ pode executar o sistema de autentica√ß√£o e come√ßar a utiliz√°-lo.</p>

    <h2>Contribui√ß√µes</h2>
    <p>Sinta-se √† vontade para contribuir com melhorias ou relatar problemas. Pull requests s√£o bem-vindos!</p>

    <h2>Licen√ßa</h2>
    <p>Este projeto est√° licenciado sob a MIT License. Consulte o arquivo <code>LICENSE</code> para mais detalhes.</p>

    <script>
        function copyCode(button) {
            const codeBlock = button.nextElementSibling;
            const code = codeBlock.textContent;
            navigator.clipboard.writeText(code).then(() => {
                button.textContent = '‚úÖ Copiado!';
                setTimeout(() => {
                    button.textContent = 'üìã Copiar';
                }, 2000);
            }).catch(err => {
                console.error('Erro ao copiar: ', err);
            });
        }
    </script>
</body>
</html>
